-- Criação do banco de dados
CREATE DATABASE IF NOT EXISTS `thecrow` CHARACTER SET utf8mb4 COLLATE=utf8mb4_unicode_ci;
USE `thecrow`;

-- Tabela para armazenar informações sobre corvos
CREATE TABLE `Crow` (
    `CrowId` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    `QrCode` VARCHAR(50) NOT NULL,
    `Name` VARCHAR(150) NOT NULL,
    `Tip` VARCHAR(100) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Tabela para armazenar fotografias
CREATE TABLE `Photograph` (
    `PhotoId` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    `Photo` MEDIUMBLOB NOT NULL,
    `PhotoType` VARCHAR(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Tabela para definir tipos de usuário
CREATE TABLE `UserType` (
    `UserTypeId` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    `Description` VARCHAR(50) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Tabela para armazenar informações dos usuários
CREATE TABLE `User` (
    `UserId` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    `Username` VARCHAR(250) NOT NULL,
    `Email` VARCHAR(250) NOT NULL UNIQUE,
    `Password` VARCHAR(100) NOT NULL,
    `UserTypeId` INT NOT NULL,
    `PhotoId` INT NOT NULL,
    FOREIGN KEY (`UserTypeId`) REFERENCES `UserType`(`UserTypeId`) ON DELETE CASCADE,
    FOREIGN KEY (`PhotoId`) REFERENCES `Photograph`(`PhotoId`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;


-- Tabela para armazenar classificações dos usuários para corvos
CREATE TABLE `Rank` (
    `RankId` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    `Date` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    `UserId` INT NOT NULL,
    `CrowId` INT NOT NULL,
    FOREIGN KEY (`UserId`) REFERENCES `User`(`UserId`) ON DELETE CASCADE,
    FOREIGN KEY (`CrowId`) REFERENCES `Crow`(`CrowId`) ON DELETE CASCADE,
    UNIQUE (`UserId`, `CrowId`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- Inserção de tipos de usuários
INSERT INTO `UserType` (`Description`) VALUES ('Admin'), ('User');



